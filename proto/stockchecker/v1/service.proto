syntax = "proto3";

package stockchecker.v1;

// Store represents a Best Buy store location
message Store {
  string store_id = 1;
  string name = 2;
  string address = 3;
  string city = 4;
  string state = 5;
  string postal_code = 6;
  string phone = 7;
  double distance_miles = 8;
}

// Product represents a Best Buy product
message Product {
  string sku = 1;
  string name = 2;
  double sale_price = 3;
  string thumbnail_url = 4;
  string product_url = 5;
}

// StockStatus represents the availability of a product at a store
message StockStatus {
  Store store = 1;
  Product product = 2;
  bool in_stock = 3;
  bool low_stock = 4;
  bool pickup_eligible = 5;
}

// User represents an authenticated user
message User {
  int32 id = 1;
  string email = 2;
  string name = 3;
  string picture_url = 4;
}

// SearchStoresRequest is the request for searching stores
message SearchStoresRequest {
  string postal_code = 1;
  int32 radius_miles = 2; // defaults to 25 if not specified
}

// SearchStoresResponse is the response containing matching stores
message SearchStoresResponse {
  repeated Store stores = 1;
}

// SearchProductsRequest is the request for searching products
message SearchProductsRequest {
  string query = 1; // search term or SKU
  string category = 2; // optional category filter (e.g., "POKEMON CARDS")
}

// SearchProductsResponse is the response containing matching products
message SearchProductsResponse {
  repeated Product products = 1;
}

// CheckStockRequest is the request for checking stock
message CheckStockRequest {
  repeated string store_ids = 1;
  repeated string skus = 2;
}

// CheckStockResponse is the response containing stock status
message CheckStockResponse {
  repeated StockStatus results = 1;
}

// GetCurrentUserRequest is empty - user is determined from session
message GetCurrentUserRequest {}

// GetCurrentUserResponse returns the current user
message GetCurrentUserResponse {
  User user = 1;
}

// GetMyStoresRequest is empty - user is determined from session
message GetMyStoresRequest {}

// GetMyStoresResponse returns the user's saved stores
message GetMyStoresResponse {
  repeated Store stores = 1;
}

// AddMyStoreRequest adds a store to the user's list
message AddMyStoreRequest {
  Store store = 1;
}

// AddMyStoreResponse is empty on success
message AddMyStoreResponse {}

// RemoveMyStoreRequest removes a store from the user's list
message RemoveMyStoreRequest {
  string store_id = 1;
}

// RemoveMyStoreResponse is empty on success
message RemoveMyStoreResponse {}

// GetMyProductsRequest is empty - user is determined from session
message GetMyProductsRequest {}

// GetMyProductsResponse returns the user's saved products
message GetMyProductsResponse {
  repeated Product products = 1;
}

// AddMyProductRequest adds a product to the user's list
message AddMyProductRequest {
  Product product = 1;
}

// AddMyProductResponse is empty on success
message AddMyProductResponse {}

// RemoveMyProductRequest removes a product from the user's list
message RemoveMyProductRequest {
  string sku = 1;
}

// RemoveMyProductResponse is empty on success
message RemoveMyProductResponse {}

// BrowsePokemonProductsRequest is empty
message BrowsePokemonProductsRequest {}

// BrowsePokemonProductsResponse returns Pokemon products from the trading cards category
message BrowsePokemonProductsResponse {
  repeated Product products = 1;
}

// StockCheckerService provides stock checking functionality
service StockCheckerService {
  // SearchStores searches for Best Buy stores near a location
  rpc SearchStores(SearchStoresRequest) returns (SearchStoresResponse);

  // SearchProducts searches for products by keyword or SKU
  rpc SearchProducts(SearchProductsRequest) returns (SearchProductsResponse);

  // CheckStock checks inventory for products at specified stores
  rpc CheckStock(CheckStockRequest) returns (CheckStockResponse);

  // GetCurrentUser returns the currently authenticated user
  rpc GetCurrentUser(GetCurrentUserRequest) returns (GetCurrentUserResponse);

  // GetMyStores returns the user's saved stores
  rpc GetMyStores(GetMyStoresRequest) returns (GetMyStoresResponse);

  // AddMyStore adds a store to the user's list
  rpc AddMyStore(AddMyStoreRequest) returns (AddMyStoreResponse);

  // RemoveMyStore removes a store from the user's list
  rpc RemoveMyStore(RemoveMyStoreRequest) returns (RemoveMyStoreResponse);

  // GetMyProducts returns the user's saved products
  rpc GetMyProducts(GetMyProductsRequest) returns (GetMyProductsResponse);

  // AddMyProduct adds a product to the user's list
  rpc AddMyProduct(AddMyProductRequest) returns (AddMyProductResponse);

  // RemoveMyProduct removes a product from the user's list
  rpc RemoveMyProduct(RemoveMyProductRequest) returns (RemoveMyProductResponse);

  // BrowsePokemonProducts returns Pokemon products from Best Buy's trading cards category
  rpc BrowsePokemonProducts(BrowsePokemonProductsRequest) returns (BrowsePokemonProductsResponse);
}
